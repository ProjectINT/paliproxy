# Tests

ะะฐะฟะบะฐ ั ัะตััะฐะผะธ ะดะปั ProxyManager. ะัะต ัะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะธัะฐัั ะฟัะตะดัะดััะธะต ะปะพะณะธ ะฟะตัะตะด ะทะฐะฟััะบะพะผ.

## ๐ ะัััััะน ััะฐัั

```bash
# ะะฐะฟัััะธัั ะะกะ ัะตััั (ัะตะบะพะผะตะฝะดัะตะผัะน ัะฟะพัะพะฑ)
npm test
```

ะญัะฐ ะบะพะผะฐะฝะดะฐ ะทะฐะฟัััะธั ัะฟัะฐะฒะปัััะธะน ัะบัะธะฟั `run-all-tests.js`, ะบะพัะพััะน:
- โ ะัะพะฒะตัะธั ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั
- ๐งน ะัะธััะธั ะฟัะตะดัะดััะธะต ะปะพะณะธ
- ๐ ะะพัะปะตะดะพะฒะฐัะตะปัะฝะพ ะทะฐะฟัััะธั ะฒัะต ัะตััั
- ๐ ะัะฒะตะดะตั ะฟะพะดัะพะฑะฝัะน ะพััะตั ะพ ัะตะทัะปััะฐัะฐั

## โ๏ธ ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั

**ะะฑัะทะฐัะตะปัะฝะพ** ะฟะตัะตะด ะทะฐะฟััะบะพะผ ัะตััะพะฒ:

### 1. ะกะพะทะดะฐะนัะต ัะฐะนะป `.env` ะฒ ะบะพัะฝะต ะฟัะพะตะบัะฐ:
```env
# Environment Configuration
NODE_ENV=development
TIMEOUT=5000
HEALTH_CHECK_INTERVAL=60000
HEALTH_CHECK_URL=https://httpbin.org/ip

CHAT_GPT_API_KEY="your_chat_gpt_api_key_here"
```

### 2. ะกะพะทะดะฐะนัะต ัะฐะนะป `proxies-list.js` ั ัะฐะฑะพัะธะผะธ ะฟัะพะบัะธ:
```javascript
module.exports = [
  { ip: '1.2.3.4', port: 1080, user: 'username', pass: 'password' },
  { ip: '5.6.7.8', port: 1080, user: 'username', pass: 'password' },
  // ะดะพะฑะฐะฒััะต ะฒะฐัะธ ัะฐะฑะพัะธะต ะฟัะพะบัะธ
];
```

## ๐ ะกะฟะธัะพะบ ัะตััะพะฒ

ะฃะฟัะฐะฒะปัััะธะน ัะบัะธะฟั ะทะฐะฟััะบะฐะตั ัะปะตะดัััะธะต ัะตััั:

## ๐ ะกะฟะธัะพะบ ัะตััะพะฒ

ะฃะฟัะฐะฒะปัััะธะน ัะบัะธะฟั ะทะฐะฟััะบะฐะตั ัะปะตะดัััะธะต ัะตััั:

### 1. ๐ ะะฐะทะพะฒัะน ัะตัั ะฟัะพะบัะธ (`proxy-basic-test.js`)
**ะัะฝะพะฒะฝะพะน ัะตัั ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ ProxyManager**
- ะะฐะฑะพัะฐ ั ัะตะฐะปัะฝัะผะธ ะฟัะพะบัะธ ะธะท `proxies-list.js`
- ะะฐะฟัะพัั ะบ ะฝะตัะบะพะปัะบะธะผ URL ะดะปั ะฟัะพะฒะตัะบะธ IP
- ะกัะฐะฝะดะฐััะฝะฐั ะบะพะฝัะธะณััะฐัะธั ProxyManager
- ะะฐะทะพะฒะพะต ะปะพะณะธัะพะฒะฐะฝะธะต

### 2. ๐ ะัะปะฐะดะพัะฝัะน ัะตัั ะฟัะพะบัะธ (`proxy-debug-test.js`)
**ะะตัะฐะปัะฝัะน ะพัะปะฐะดะพัะฝัะน ัะตัั ั ัะฐััะธัะตะฝะฝัะผ ะปะพะณะธัะพะฒะฐะฝะธะตะผ**
- ะะพะดัะพะฑะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ั ะฒัะตะผะตะฝะฝัะผะธ ะผะตัะบะฐะผะธ
- ะะดะธะฝ URL ะดะปั ัะฟัะพัะตะฝะฝะพะน ะพัะปะฐะดะบะธ
- ะะฐััะธัะตะฝะฝัะต ัะฐะนะผะฐััั ะดะปั ะฐะฝะฐะปะธะทะฐ
- ะะตัะฐะปัะฝะฐั ััะฐััะธัะพะฒะบะฐ ะพัะธะฑะพะบ

### 3. ๐ ะขะตัั ะพัะบะฐะทะพัััะพะนัะธะฒะพััะธ (`proxy-failover-test.js`)
**ะขะตัั ะฟะตัะตะบะปััะตะฝะธั ะผะตะถะดั ะฟัะพะบัะธ ะฟัะธ ัะฑะพัั**

### 4. ๐ ะขะตัั ะพัะบะฐะทะพัััะพะนัะธะฒะพััะธ ั ะฟะฐัะพะปะตะผ (`proxy-failover-password-test.js`)
**ะขะตัั ะฟะตัะตะบะปััะตะฝะธั ะฟัะพะบัะธ ั ะฐััะตะฝัะธัะธะบะฐัะธะตะน**

### 5. ๐ ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ะฟัะพะบัะธ (`health-check-test.js`)
**ะขะตัั ัะธััะตะผั ะผะพะฝะธัะพัะธะฝะณะฐ ัะพััะพัะฝะธั ะฟัะพะบัะธ**

### 6. ๐ ะขะตัั API ะทะฐะฟัะพัะพะฒ (`request-api-test.js`)
**ะขะตัั fetch-like API ะดะปั ัะฐะฑะพัั ั ะทะฐะฟัะพัะฐะผะธ**

### 7. โก ะัััััะน ะธะฝัะตะณัะฐัะธะพะฝะฝัะน ัะตัั (`quick-integration-test.js`)
**ะััััะฐั ะฟัะพะฒะตัะบะฐ ะพัะฝะพะฒะฝัั ะบะพะผะฟะพะฝะตะฝัะพะฒ**

### 8. ๐ฆ ะขะตัั ะฟะฐะบะตัะฐ (`test-package.js`)
**ะขะตัั ัััะฐะฝะพะฒะปะตะฝะฝะพะณะพ npm ะฟะฐะบะตัะฐ**

### 9. ๐ต ะขะตัั TTS ReadableStream (`tts-readablestream-test.js`)
**ะขะตัั ัะฐะฑะพัั ั ะฟะพัะพะบะพะฒัะผะธ ะดะฐะฝะฝัะผะธ ัะตัะตะท ะฟัะพะบัะธ**

## ๐ฏ ะะฝะดะธะฒะธะดัะฐะปัะฝัะน ะทะฐะฟััะบ ัะตััะพะฒ

ะัะปะธ ะฝะตะพะฑัะพะดะธะผะพ ะทะฐะฟัััะธัั ะบะพะฝะบัะตัะฝัะน ัะตัั:
## ๐ฏ ะะฝะดะธะฒะธะดัะฐะปัะฝัะน ะทะฐะฟััะบ ัะตััะพะฒ

ะัะปะธ ะฝะตะพะฑัะพะดะธะผะพ ะทะฐะฟัััะธัั ะบะพะฝะบัะตัะฝัะน ัะตัั:

```bash
# ะัะฝะพะฒะฝะพะน ัะตัั ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ
node tests/proxy-basic-test.js

# ะะตัะฐะปัะฝะฐั ะพัะปะฐะดะบะฐ
node tests/proxy-debug-test.js

# ะขะตัั ะพัะบะฐะทะพัััะพะนัะธะฒะพััะธ
node tests/proxy-failover-test.js

# ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ะฟัะพะบัะธ
node tests/health-check-test.js

# ะขะตัั API ะทะฐะฟัะพัะพะฒ
node tests/request-api-test.js

# ะ ะดััะณะธะต ัะตััั...
```

## ๐ ะะตะทัะปััะฐัั ัะตััะธัะพะฒะฐะฝะธั

ะะพัะปะต ะทะฐะฟััะบะฐ `npm test` ะฒั ะฟะพะปััะธัะต:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ะะะะฃะกะ ะะกะะฅ ะขะะกะขะะ PROXY-CONNECTION
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

๐ ะัะพะฒะตัะบะฐ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั...
โ ะัะตะดะฒะฐัะธัะตะปัะฝะฐั ะฟัะพะฒะตัะบะฐ ะทะฐะฒะตััะตะฝะฐ

๐งน ะัะธััะบะฐ ะฟัะตะดัะดััะธั ะปะพะณะพะฒ...

๐ ะะฐะทะพะฒัะน ัะตัั ะฟัะพะบัะธ
   ะัะฝะพะฒะฝะพะน ัะตัั ััะฝะบัะธะพะฝะฐะปัะฝะพััะธ ProxyManager
๐ง ะะฐะฟััะบ: proxy-basic-test.js
โ ะขะตัั ะทะฐะฒะตััะตะฝ ััะฟะตัะฝะพ (1250ms)

...

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ะะขะงะะข ะ ะะะะฃะะฌะขะะขะะฅ ะขะะกะขะะ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ ะฃัะฟะตัะฝะพ: 8
โ ะะตัะดะฐัะฝะพ: 1
โฑ๏ธ  ะะฑัะตะต ะฒัะตะผั: 15420ms

๐ ะะตัะฐะปัะฝัะต ัะตะทัะปััะฐัั:
   โ ะฃะกะะะฅ ะะฐะทะพะฒัะน ัะตัั ะฟัะพะบัะธ (1250ms)
   โ ะฃะกะะะฅ ะัะปะฐะดะพัะฝัะน ัะตัั ะฟัะพะบัะธ (2100ms)
   ...

๐ ะะพะณะธ ัะพััะฐะฝะตะฝั ะฒ ะฟะฐะฟะบะต logs/
```

## ๐ ะัััััะน ะทะฐะฟััะบ

```bash
# ะัะต ัะตััั ะพะดะฝะพะน ะบะพะผะฐะฝะดะพะน (ัะตะบะพะผะตะฝะดัะตััั)
npm test
```

---

## ะัะพะฑะตะฝะฝะพััะธ

### ๐๏ธ ะะฒัะพะผะฐัะธัะตัะบะฐั ะพัะธััะบะฐ ะปะพะณะพะฒ
ะัะต ัะตััั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพัะธัะฐัั ะฟัะตะดัะดััะธะต `.log` ัะฐะนะปั ะฒ ะฟะฐะฟะบะต `logs/` ะฟะตัะตะด ะทะฐะฟััะบะพะผ ะดะปั ะธะทะฑะตะถะฐะฝะธั ะฟััะฐะฝะธัั ะฟัะธ ะพัะปะฐะดะบะต.

### ๐ ะกัััะบัััะฐ ะปะพะณะพะฒ
```
logs/
โโโ proxy-basic-test.log    # ะะตะทัะปััะฐัั ะพัะฝะพะฒะฝะพะณะพ ัะตััะฐ
โโโ proxy-debug-test.log    # ะะตัะฐะปัะฝัะต ะพัะปะฐะดะพัะฝัะต ะปะพะณะธ
โโโ app.log                 # ะกะธััะตะผะฝัะต ะปะพะณะธ ProxyManager (ะฐะฒัะพะผะฐัะธัะตัะบะธะต)
```

### โ๏ธ ะะพะฝัะธะณััะฐัะธั ProxyManager

**ะัะฝะพะฒะฝัะต ะฟะฐัะฐะผะตััั:**
- `healthCheckUrl` - URL ะดะปั ะฟัะพะฒะตัะบะธ ัะฐะฑะพัะพัะฟะพัะพะฑะฝะพััะธ ะฟัะพะบัะธ
- `healthCheckInterval` - ะะฝัะตัะฒะฐะป ะฟัะพะฒะตัะบะธ ะฟัะพะบัะธ (ms)
- `maxTimeout` - ะะฐะบัะธะผะฐะปัะฝัะน ัะฐะนะผะฐัั ะทะฐะฟัะพัะฐ (ms)
- `changeProxyLoop` - ะะพะปะธัะตััะฒะพ ัะธะบะปะพะฒ ัะผะตะฝั ะฟัะพะบัะธ ะฟัะธ ะฝะตัะดะฐัะต

### ๐ฏ ะฆะตะปะธ ัะตััะธัะพะฒะฐะฝะธั

1. **ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั** - ะฟัะพะฒะตัะบะฐ ะฑะฐะทะพะฒะพะน ัะฐะฑะพัั ั ะฟัะพะบัะธ
2. **ะกัะฐะฑะธะปัะฝะพััั** - ัะตััะธัะพะฒะฐะฝะธะต ะพะฑัะฐะฑะพัะบะธ ะพัะธะฑะพะบ
3. **ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั** - ะธะทะผะตัะตะฝะธะต ะฒัะตะผะตะฝะธ ะพัะบะปะธะบะฐ
4. **ะะพะณะธัะพะฒะฐะฝะธะต** - ะฟัะพะฒะตัะบะฐ ะบะพััะตะบัะฝะพััะธ ะปะพะณะพะฒ

### ๐ ะะฝัะตัะฟัะตัะฐัะธั ัะตะทัะปััะฐัะพะฒ

**ะฃัะฟะตัะฝัะน ัะตัั:**
```
โ [URL] Status: 200, IP: xxx.xxx.xxx.xxx
```

**ะัะธะฑะบะฐ:**
```
โ [URL] Error: ะพะฟะธัะฐะฝะธะต ะพัะธะฑะบะธ
```

**ะ ะพัะปะฐะดะพัะฝะพะผ ัะตะถะธะผะต ะดะพะฟะพะปะฝะธัะตะปัะฝะพ:**
- ะัะตะผะตะฝะฝัะต ะผะตัะบะธ ะฝะฐัะฐะปะฐ/ะทะฐะฒะตััะตะฝะธั
- ะะปะธัะตะปัะฝะพััั ะทะฐะฟัะพัะฐ ะฒ ะผะธะปะปะธัะตะบัะฝะดะฐั
- ะะพะดัะพะฑะฝัะน ััะตะบ ะพัะธะฑะพะบ

### ๐ง ะัะปะฐะดะบะฐ ะฟัะพะฑะปะตะผ

1. **ะกะฝะฐัะฐะปะฐ ะทะฐะฟัััะธัะต** `proxy-debug-test.js` ะดะปั ะดะตัะฐะปัะฝะพะณะพ ะฐะฝะฐะปะธะทะฐ
2. **ะัะพะฒะตัััะต ะปะพะณะธ** ะฒ `logs/proxy-debug-test.log`
3. **ะะฝะฐะปะธะทะธััะนัะต** ัะธััะตะผะฝัะต ะปะพะณะธ ะฒ `logs/app.log`
4. **ะัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ** ะธะทะผะตะฝะธัะต ะบะพะฝัะธะณััะฐัะธั ะฒ ัะตััะพะฒ

### ๐ฆ ะกัะฐัััั ัะตััะพะฒ

- **โ ะฃัะฟะตั** - ะฟัะพะบัะธ ัะฐะฑะพัะฐะตั, ะฟะพะปััะตะฝ ะบะพััะตะบัะฝัะน ะพัะฒะตั
- **โ ะัะธะฑะบะฐ** - ะฟัะพะฑะปะตะผั ั ะฟัะพะบัะธ ะธะปะธ ัะตััั
- **โฑ๏ธ ะขะฐะนะผะฐัั** - ะฟัะตะฒััะตะฝะพ ะฒัะตะผั ะพะถะธะดะฐะฝะธั
- **๐ ะะพะฒัะพั** - ะฟะพะฟััะบะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะดััะณะพะณะพ ะฟัะพะบัะธ
