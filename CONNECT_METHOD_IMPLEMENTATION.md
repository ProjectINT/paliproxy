# –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞ connect() –≤ PaliVPN

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞

**–ó–∞–¥–∞—á–∞:** –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ `connect(vpn)` –≤ –∫–ª–∞—Å—Å–µ VPNManager, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –Ω–µ–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (—Ç–æ–ª—å–∫–æ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π).

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã

### 1. –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ `connect()`

**–§–∞–π–ª:** `src/manager.ts`

**–ß—Ç–æ –±—ã–ª–æ:**
```typescript
async connect(vpn: VPNConfig): Promise<void> {
    // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPN
    // –ü–æ–∫–∞ —Å–∏–º—É–ª–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    await delay(2000);
    // ...–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
}
```

**–ß—Ç–æ —Å—Ç–∞–ª–æ:**
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–µ–∞–ª—å–Ω—ã–º VPN —Å–µ—Ä–≤–µ—Ä–∞–º
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—Ä–µ—Ö —Ç–∏–ø–æ–≤ VPN: OpenVPN, WireGuard, IKEv2
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è VPN –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ inline –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É IP –∞–¥—Ä–µ—Å–∞
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –æ—Ç–∫–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è

### 2. –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:
- `establishVPNConnection(vpn)` - –¥–∏—Å–ø–µ—Ç—á–µ—Ä –ø–æ —Ç–∏–ø–∞–º VPN
- `connectOpenVPN(vpn)` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ OpenVPN –∫–ª–∏–µ–Ω—Ç
- `connectWireGuard(vpn)` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WireGuard
- `connectIKEv2(vpn)` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ strongSwan IKEv2

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è:
- `verifyConnection(vpn)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ (tun/tap –¥–ª—è OpenVPN, wg –¥–ª—è WireGuard)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è IP –∞–¥—Ä–µ—Å–∞ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å

#### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ:
- `terminateVPNConnection(vpn)` - –¥–∏—Å–ø–µ—Ç—á–µ—Ä –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- `disconnectOpenVPN(vpn)` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ OpenVPN –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- `disconnectWireGuard(vpn)` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ WireGuard –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- `disconnectIKEv2(vpn)` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ IKEv2 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### 3. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

#### OpenVPN:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `openvpn` –∫–ª–∏–µ–Ω—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ username/password
- –°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è inline –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ó–∞–ø—É—Å–∫ –∫–∞–∫ daemon —Å PID —Ñ–∞–π–ª–æ–º
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –ø–æ PID

#### WireGuard:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `wg-quick` –∏ `wireguard-tools`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ inline –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏ —á–µ—Ä–µ–∑ `wg-quick up/down`

#### IKEv2:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `strongswan` (ipsec)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ `ipsec up/down`

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å:
- –ó–∞—â–∏—Ç–∞ –æ—Ç race conditions —á–µ—Ä–µ–∑ –º—å—é—Ç–µ–∫—Å—ã –∏ —Å–µ–º–∞—Ñ–æ—Ä—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –æ—Ç–∫–∞—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `disconnect()`

–¢–∞–∫–∂–µ –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω –º–µ—Ç–æ–¥ `disconnect()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ VPN.

### 5. –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä

**–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª:** `example/vpn-connection-demo.ts`

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ä–∞–∑–Ω—ã–º —Ç–∏–ø–∞–º VPN
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É VPN —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:**
```bash
npm run example:vpn-connection
```

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

#### README.md:
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è API –¥–ª—è VPNManager
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ VPN
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–æ–≤–æ–º –¥–µ–º–æ –ø—Ä–∏–º–µ—Ä–µ

#### IMPLEMENTATION_ISSUES.md:
- –û—Ç–º–µ—á–µ–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å `connect()` –º–µ—Ç–æ–¥–æ–º
- –î–æ–±–∞–≤–ª–µ–Ω –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

#### package.json:
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `example:vpn-connection`

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```typescript
interface VPNConfig {
    name: string;
    config: string; // –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –∏–ª–∏ inline –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    priority: number;
    active: boolean;
    type?: 'openvpn' | 'wireguard' | 'ikev2';
    auth?: {
        username?: string;
        password?: string;
    };
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

–ú–µ—Ç–æ–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤:
- OpenVPN: –∫–æ–º–∞–Ω–¥–∞ `openvpn`
- WireGuard: –∫–æ–º–∞–Ω–¥–∞ `wg-quick`
- IKEv2: –∫–æ–º–∞–Ω–¥–∞ `ipsec`

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π:

–¢–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–æ–±—ã—Ç–∏—è:
- `connected` - –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- `disconnected` - –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏  
- `switched` - –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ VPN

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ú–µ—Ç–æ–¥ `connect(vpn)` —Ç–µ–ø–µ—Ä—å:

1. **–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω** - –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ VPN
2. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω** - –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 3 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–∏–ø–∞ VPN
3. **–ù–∞–¥–µ–∂–µ–Ω** - –∏–º–µ–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—à–∏–±–æ–∫ –∏ –æ—Ç–∫–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
4. **–ë–µ–∑–æ–ø–∞—Å–µ–Ω** - –∑–∞—â–∏—â–µ–Ω –æ—Ç race conditions
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω** - –∏–º–µ–µ—Ç –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ü—Ä–æ–±–ª–µ–º–∞ –∏–∑ `IMPLEMENTATION_ISSUES.md` –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞. –¢–µ–ø–µ—Ä—å PaliVPN –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ VPN —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏—Ö.

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ VPN –∫–ª–∏–µ–Ω—Ç—ã:**
   ```bash
   # Ubuntu/Debian
   sudo apt install openvpn wireguard-tools strongswan
   
   # macOS
   brew install openvpn wireguard-tools strongswan
   ```

2. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ VPN**

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é:**
   ```bash
   npm run example:vpn-connection
   ```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ë–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö VPN –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–∫–∞–∂–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–µ –æ—à–∏–±–∫–∏, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
